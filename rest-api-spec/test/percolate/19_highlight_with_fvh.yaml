---
"Basic percolation highlight fvh with inner objects":

  - do:
      indices.create:
        index: testidx
        body: {"mappings":{"mail":{"properties":{"body":{"properties":{"text":{"type":"string","term_vector":"with_positions_offsets"}}}}}}}

  - do:
      index:
        index: testidx
        type: .percolator
        id:  Q
        body: {"query":{"match":{"body.text":{"query":"foo bar","type":"phrase"}}}}
  - do:
      indices.refresh: {}


  - do:
      percolate:
        index: testidx
        type:  mail
        body: {"doc":{"body":[{"text":"la la"},{"text":"foo bar foo bar foo"}]},"size":2,"highlight":{"fields":{"body.text":{"type":"fvh"}}}}

  - match: {'total': 1}
  - match: {'matches.0.highlight.body\\.text.0': "<em>foo bar</em> <em>foo bar</em> foo"}

